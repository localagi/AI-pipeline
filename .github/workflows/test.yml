name: Publish Docker images

on:
  push:
    branches: [main]
  workflow_dispatch:

permissions:
  packages: write
  contents: read

jobs:

  build-hello-universe:
    uses: ./.github/workflows/operation-docker-build-publish.yml
    with:
      image-name: ${{ github.repository_owner }}/hello-universe
    secrets: inherit

  build-hello-outerspace:
    uses: ./.github/workflows/operation-docker-build-publish.yml
    with:
      image-name: ${{ github.repository_owner }}/hello-outerspace
      dockerfile: Dockerfile.dependent
      build-args: |
        FROM_IMAGE=${{needs.build-hello-universe.outputs.primary-image}}
    secrets: inherit
    needs: build-hello-universe
